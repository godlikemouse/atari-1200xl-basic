100 REM SETUP PMG & MEMORY VARS
110 DIM PM$(2048)
120 PM$(1)=CHR$(0):PM$(2048)=CHR$(0):PM$(2)=PM$
130 DIM CLEAR$(128):CLEAR$(1)=CHR$(0):CLEAR$(128)=CHR$(0):CLEAR$(2)=CLEAR$

200 REM MEMORY LOCATIONS
210 PMGMEM=54279
220 P0CMEM=704
230 DMACTL=559
240 GRACTL=53277
250 P0XMEM=53248
260 JOYSTICK=632

1000 REM INITIALIZE GRAPHICS AND PMG
1010 GR.8
1020 SETCOLOR 2,0,0
1030 A=ADR(PM$)
1040 PMBASE=INT(A/1024)*1024
1050 IF PMBASE<A THEN PMBASE=PMBASE+1024
1060 S=PMBASE-A
1070 P0=S+1024
1080 POKE PMGMEM,PMBASE/256
1090 POKE P0CMEM,20:POKE DMACTL,62:POKE GRACTL,3

2000 REM INITIALIZE PLAYER GRAPHICS AND LOCATION
2010 DIM PLAYER0$(256):PLAYER0$(1)=CHR$(0):PLAYER0$(256)=CHR$(0):PLAYER0$(2)=PLAYER0$:REM FILL WITH CHR$(0)
2020 PPX=120:POKE P0XMEM,PPX
2030 PPY=50
2040 FOR I=1 TO 8:READ A:PLAYER0$(I,I)=CHR$(A):NEXT I
2050 PM$(P0+PPY)=PLAYER0$

3000 REM MAIN LOOP
3010 GOSUB 4010
3030 GOTO 3010

4000 REM UPDATE PLAYER 0 POSITION
4010 KEY=PEEK(53769)
4020 JOY=PEEK(JOYSTICK)
4030 IF PEEK(753)=0 AND JOY=15 THEN RETURN
4040 IF KEY=19 OR JOY=11 THEN DX=-2
4050 IF KEY=20 OR JOY=7 THEN DX=2
4060 IF KEY=3 OR JOY=14 THEN DY=-2
4070 IF KEY=4 OR JOY=13 THEN DY=2
4080 PPX=PPX+DX
4090 IF DY>0 THEN PM$(P0+PPY,P0+PPY+1)=CLEAR$
4100 PPY=PPY+DY
4110 IF DY<>0 THEN PM$(P0+PPY)=PLAYER0$
4120 DX=0:DY=0
4130 POKE P0XMEM,PPX
4140 RETURN

5000 REM PLAYER 0 GRAPHIC DATA
5010 DATA 60,126,247,251,255,255,126,60
